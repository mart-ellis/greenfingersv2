---
import FilmPreview from "../components/FilmPreview.astro";
import Title from "../components/Title.astro";
import films from "../data/films.json";
---

<section>
  <Title>Our Recent Films</Title>
  <div>
    {films.map((film, index) => <FilmPreview film={film} index={index} />)}
  </div>
</section>

<style>
  div {
    display: flex;
    flex-direction: column;
    gap: 4rem;
    margin-top: 1rem;
  }
</style>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  document.addEventListener("DOMContentLoaded", () => {
    document.body.scrollTop = document.documentElement.scrollTop = 0;
    let previews = gsap.utils.toArray(".film-preview");

    previews.forEach((preview) => {
      gsap.to(preview, {
        keyframes: [{ filter: "grayscale(0)" }, { filter: "grayscale(1)" }],
        scrollTrigger: {
          trigger: preview,
          start: "top 90%",
          end: "bottom 20%",
          scrub: true,
          markers: true,
        },
      });
    });
  });
</script>
